/*
 * This file is part of the TYPO3 CMS project.
 *
 * It is free software; you can redistribute it and/or modify it under
 * the terms of the GNU General Public License, either version 2
 * of the License, or any later version.
 *
 * For the full copyright and license information, please read the
 * LICENSE.txt file that was distributed with this source code.
 *
 * The TYPO3 project - inspiring people to share!
 */
import{LitElement as v,html as i}from"lit";import{state as h,customElement as b}from"lit/decorators.js";import{repeat as y}from"lit/directives/repeat.js";import m,{OpenDocumentStoreChangedEvent as p}from"@typo3/opendocs/open-document-store.js";import"@typo3/backend/element/icon-element.js";import"@typo3/backend/element/breadcrumb.js";import"@typo3/backend/element/datetime-element.js";import d from"~labels/opendocs.messages";var u=function(r,e,n,o){var c=arguments.length,t=c<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,n):o,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")t=Reflect.decorate(r,e,n,o);else for(var s=r.length-1;s>=0;s--)(a=r[s])&&(t=(c<3?a(t):c>3?a(e,n,t):a(e,n))||t);return c>3&&t&&Object.defineProperty(e,n,t),t};let l=class extends v{constructor(){super(...arguments),this.recentDocuments=[],this.handleStoreUpdate=()=>{this.syncFromStore()}}connectedCallback(){super.connectedCallback(),document.addEventListener(p,this.handleStoreUpdate),this.syncFromStore()}disconnectedCallback(){super.disconnectedCallback(),document.removeEventListener(p,this.handleStoreUpdate)}createRenderRoot(){return this}render(){return i`<p class=dropdown-headline>${d.get("toolbarItems.headline")}</p>${this.recentDocuments.length>0?i`<ul class=dropdown-list role=menu aria-label=${d.get("toolbarItems.headline")}>${y(this.recentDocuments,e=>e.identifier,e=>this.renderRecentDocumentItem(e))}</ul>`:i`<p class=dropdown-item-text>${d.get("recentDocuments.emptyList")}</p>`}`}async syncFromStore(){this.recentDocuments=await m.getRecentDocuments()}renderRecentDocumentItem(e){return i`<li><button type=button role=menuitem class=dropdown-item @click=${()=>this.handleNavigate(e)}><div class=activity><div class=activity-icon><typo3-backend-icon identifier=${e.iconIdentifier} overlay=${e.iconOverlayIdentifier||""} size=small></typo3-backend-icon></div><div class=activity-title>${e.title}</div><div class=activity-time><typo3-backend-datetime datetime=${e.updatedAt} mode=relative></typo3-backend-datetime></div><div class=activity-source>${e.breadcrumb.length>0?i`<typo3-breadcrumb .nodes=${e.breadcrumb.slice(0,-1)} mode=path label=${d.get("recentDocuments.path")} condensed></typo3-breadcrumb>`:""}</div></div></button></li>`}handleNavigate(e){m.navigate(e)}};u([h()],l.prototype,"recentDocuments",void 0),l=u([b("typo3-open-document-menu")],l);export{l as OpenDocumentMenuElement};
