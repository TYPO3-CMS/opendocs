/*
 * This file is part of the TYPO3 CMS project.
 *
 * It is free software; you can redistribute it and/or modify it under
 * the terms of the GNU General Public License, either version 2
 * of the License, or any later version.
 *
 * For the full copyright and license information, please read the
 * LICENSE.txt file that was distributed with this source code.
 *
 * The TYPO3 project - inspiring people to share!
 */
import{LitElement as v,html as s}from"lit";import{state as b,customElement as h}from"lit/decorators.js";import{repeat as f}from"lit/directives/repeat.js";import l,{OpenDocumentStoreChangedEvent as m}from"@typo3/opendocs/open-document-store.js";import"@typo3/backend/element/icon-element.js";import"@typo3/backend/element/breadcrumb.js";import"@typo3/backend/element/datetime-element.js";import u from"~labels/opendocs.messages";var p=function(n,e,t,c){var o=arguments.length,i=o<3?e:c===null?c=Object.getOwnPropertyDescriptor(e,t):c,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(n,e,t,c);else for(var a=n.length-1;a>=0;a--)(r=n[a])&&(i=(o<3?r(i):o>3?r(e,t,i):r(e,t))||i);return o>3&&i&&Object.defineProperty(e,t,i),i};let d=class extends v{constructor(){super(...arguments),this.recentDocuments=[],this.handleStoreUpdate=()=>{this.syncFromStore()}}connectedCallback(){super.connectedCallback(),document.addEventListener(m,this.handleStoreUpdate),this.syncFromStore()}disconnectedCallback(){super.disconnectedCallback(),document.removeEventListener(m,this.handleStoreUpdate)}createRenderRoot(){return this}render(){return this.recentDocuments.length===0?s`<div class="callout callout-info"><div class=callout-icon><span class=icon-emphasized> <typo3-backend-icon identifier=content-widget-list size=default></typo3-backend-icon> </span></div><div class=callout-content><div class=callout-title>${u.get("recentDocuments.emptyList")}</div></div></div>`:s`<div class="widget-listgroup list-group">${f(this.recentDocuments,e=>e.identifier,e=>this.renderDocumentRow(e))}</div>`}renderDocumentRow(e){return s`<button type=button role=menuitem @click=${t=>this.handleDocumentClick(t,e)} class="list-group-item list-group-item-action"><div class=activity><div class=activity-icon><typo3-backend-icon identifier=${e.iconIdentifier} overlay=${e.iconOverlayIdentifier||""} size=small></typo3-backend-icon></div><div class=activity-title>${e.title}</div><div class=activity-time><typo3-backend-datetime datetime=${e.updatedAt} mode=relative></typo3-backend-datetime></div><div class=activity-source>${e.breadcrumb.length>0?s`<typo3-breadcrumb .nodes=${e.breadcrumb.slice(0,-1)} mode=path label=${u.get("recentDocuments.path")} condensed></typo3-breadcrumb>`:""}</div></div></button>`}async syncFromStore(){this.recentDocuments=await l.getRecentDocuments()}handleDocumentClick(e,t){e.preventDefault(),l.navigate(t)}};p([b()],d.prototype,"recentDocuments",void 0),d=p([h("typo3-opendocs-recent-documents-widget")],d);export{d as RecentDocumentsWidgetElement};
